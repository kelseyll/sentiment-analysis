<!DOCTYPE html>
<html>
<head>
    <title>Sentiment</title>

    <link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>
<input id="thoughts" class="input left-to-right" />
<div id="score"></div>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js"></script>
<script type="text/javascript">
    $( document ).ready(function() {
        $(".input").focus();
    });

    // Setup before functions.
    var typingTimer;
    var doneTypingInterval = 1000;
    var $input = $('.input');

    // On keyup, start the countdown
    $input.on('keyup', function () {
        clearTimeout(typingTimer);
        typingTimer = setTimeout(doneTyping, doneTypingInterval);
    });

    //on keydown, clear the countdown 
    $input.on('keydown', function () {
        clearTimeout(typingTimer);
    });

    //user is "finished typing," do something
    function doneTyping () {
      console.log("donetyping");
    }

    $('.input').keypress(function (e) {
        if (e.which == 13) {
            var query = $('.input').val();
            var url = window.location.href + query;
            $.get(url, function(resp) {
                console.log(resp);

                // clear values
                $('.input').val('');
                $('#output').empty();
                $('#output').append(resp.score);
                $('html').removeClass('green red white');

                if (resp.score > 0) {
                    $('html').addClass('green');
                } else if (resp.score < 0) {
                    $('html').addClass('red');
                } else {
                    $('html').addClass('white');
                }
            })
        }
    });
</script>

</body>
</html>